<html data-bs-theme="light" lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, shrink-to-fit=no"
    />
    <title>PIAF - Portal de Integração de Atividades Físicas</title>
    <link rel="stylesheet" href="../global.css" />
    <link rel="stylesheet" href="../assets/bootstrap/css/bootstrap.min.css" />
    <link rel="stylesheet" href="../assets/css/bs-theme-overrides.css" />
    <link rel="stylesheet" href="../assets/css/Navbar-Right-Links-icons.css" />
    <link rel="stylesheet" href="../assets/css/styles.css" />
    <link rel="script" href="../preload.js" />
    <link rel="script" href="../index.js" />
  </head>

  <body>
    <!-- Cabeçalho da página -->
    <nav class="navbar navbar-expand-md bg-body shadow py-3">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="#"
          ><span
            class="bs-icon-sm bs-icon-rounded bs-icon-primary d-flex justify-content-center align-items-center me-2 bs-icon"
            ><svg
              xmlns="http://www.w3.org/2000/svg"
              enable-background="new 0 0 24 24"
              height="1em"
              viewBox="0 0 24 24"
              width="1em"
              fill="currentColor"
              style="font-size: 23px"
            >
              <g>
                <rect fill="none" height="24" width="24"></rect>
              </g>
              <g>
                <g>
                  <path
                    d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M13,4.07 c3.07,0.38,5.57,2.52,6.54,5.36L13,5.65V4.07z M8,5.08c1.18-0.69,3.33-1.06,3-1.02v7.35l-3,1.73V5.08z M4.63,15.1 C4.23,14.14,4,13.1,4,12c0-2.02,0.76-3.86,2-5.27v7.58L4.63,15.1z M5.64,16.83L12,13.15l3,1.73l-6.98,4.03 C7.09,18.38,6.28,17.68,5.64,16.83z M10.42,19.84 M12,20c-0.54,0-1.07-0.06-1.58-0.16l6.58-3.8l1.36,0.78 C16.9,18.75,14.6,20,12,20z M13,11.42V7.96l7,4.05c0,1.1-0.23,2.14-0.63,3.09L13,11.42z"
                  ></path>
                </g>
              </g></svg></span
          ><span>PIAF - UFRN</span></a
        ><button
          data-bs-toggle="collapse"
          class="navbar-toggler"
          data-bs-target="#navcol-2"
        >
          <span class="visually-hidden">Toggle navigation</span
          ><span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navcol-2">
          <ul class="navbar-nav ms-auto"></ul><a
            class="btn btn-primary ms-md-2"
            role="button"
            data-bs-target="#modal_import_data"
            data-bs-toggle="modal"
            >Importar Planilha</a
          >
        </div>
      </div>
    </nav>
    <!-- Botões para adição e atribuição de alunos -->
    <section class="mt-5">
      <div class="container">
        <button class="btn btn-primary mb-3" type="button">Criar Turma</button
        ><button class="btn btn-primary mb-3 ms-1" type="button">
          Atribuir Alunos as Turmas
        </button>
        <div
          class="row border border-primary border-3 rounded"
          style="max-height: 550px; overflow-y: scroll"
        >
          <div class="col mt-2">
            <div class="card mb-2">
              <div class="card-body">
                <h4 class="card-title">Voley de Areia - Manhã 12h</h4>
                <h6 class="text-muted card-subtitle mb-2">Alunos: 00/40</h6>
                <h6 class="text-muted card-subtitle mb-2">
                  Orientadores: João, Rafael, Gabriel
                </h6>
                <button class="btn btn-primary" type="button">
                  Exportar Alunos Selecionados</button
                ><button class="btn btn-primary ms-2" type="button">
                  Apagar Turma
                </button>
              </div>
            </div>
            <div class="card mb-2">
              <div class="card-body">
                <h4 class="card-title">Voley de Areia - Manhã 12h</h4>
                <h6 class="text-muted card-subtitle mb-2">Alunos: 00/40</h6>
                <h6 class="text-muted card-subtitle mb-2">
                  Orientadores: João, Rafael, Gabriel
                </h6>
                <button class="btn btn-primary" type="button">
                  Exportar Alunos Selecionados</button
                ><button class="btn btn-primary ms-2" type="button">
                  Apagar Turma
                </button>
              </div>
            </div>
            <div class="card mb-2">
              <div class="card-body">
                <h4 class="card-title">Voley de Areia - Manhã 12h</h4>
                <h6 class="text-muted card-subtitle mb-2">Alunos: 00/40</h6>
                <h6 class="text-muted card-subtitle mb-2">
                  Orientadores: João, Rafael, Gabriel
                </h6>
                <button class="btn btn-primary" type="button">
                  Exportar Alunos Selecionados</button
                ><button class="btn btn-primary ms-2" type="button">
                  Apagar Turma
                </button>
              </div>
            </div>
            <div class="card mb-2">
              <div class="card-body">
                <h4 class="card-title">Voley de Areia - Manhã 12h</h4>
                <h6 class="text-muted card-subtitle mb-2">Alunos: 00/40</h6>
                <h6 class="text-muted card-subtitle mb-2">
                  Orientadores: João, Rafael, Gabriel
                </h6>
                <button class="btn btn-primary" type="button">
                  Exportar Alunos Selecionados</button
                ><button class="btn btn-primary ms-2" type="button">
                  Apagar Turma
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Modal de importação de dados -->
    <div class="modal fade" role="dialog" tabindex="-1" id="modal_import_data">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title">Insira a Planilha</h4>
            <button
              class="btn-close"
              type="button"
              aria-label="Close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <label class="form-label"
              >Planilha exportada do google forms <br /><strong
                >Atenção: </strong
              >Lembre-se de salvar a coluna dos horários de envio como: "Hora de
              inscrição", senão o programa não irá rodar.</label
            >
            <form>
              <label class="form-label" for="fileInput"
                >Escolha o arquivo:</label
              >
              <input
                id="input-planilha"
                class="border rounded border-1 border-primary shadow-sm form-control"
                type="file"
                accept=".xlsx, .xls"
              />
            </form>
          </div>
          <div class="modal-footer">
            <button
              class="btn btn-primary"
              type="button"
              id="uploadButton"
              onclick="console.log('envio de dados')"
            >
              Importar
            </button>
          </div>
        </div>
      </div>
    </div>
    <div class="modal fade" role="dialog" tabindex="-1" id="turma">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title">Dados da Turma</h4>
            <button
              class="btn-close"
              type="button"
              aria-label="Close"
              data-bs-dismiss="modal"
            ></button>
          </div>
          <div class="modal-body">
            <form>
              <label class="form-label">Quantidade de Alunos</label
              ><input
                class="border rounded border-1 border-primary form-control mb-2"
                type="number"
                min="1"
                name="Quantidade de alunos"
                placeholder="Quantidade Máxima da turma"
              /><label class="form-label">Nome da Turma</label
              ><input
                class="border rounded border-1 border-primary form-control"
                type="text"
                placeholder="Voley de areia"
              />
            </form>
          </div>
          <div class="modal-footer">
            <button class="btn btn-primary" type="button">Adicionar</button>
          </div>
        </div>
      </div>
    </div>
    <script src="../assets/bootstrap/js/bootstrap.min.js"></script>
    <!-- Rodapé da página -->
    <footer class="bg-body text-center py-3">
      <div class="container">
        <span class="text-muted"
          >Desenvolvido na Escola de Ciências & Tecnologia - 2024</span
        >
      </div>
    </footer>
  </body>
  <script>
    document
      .getElementById("uploadButton")
      .addEventListener("click", function (event) {
        event.preventDefault(); // Evita o envio automático do formulário
        var fileInput = document.getElementById("input-planilha");
        var file = fileInput.files[0];
        var formData = new FormData();
        formData.append("file", file);

        fetch("http://localhost:5000/upload", {
          method: "POST",
          body: formData,
        })
          .then((response) => {
            if (!response.ok) {
              throw new Error("Erro ao processar a planilha");
            }
            return response.blob();
          })
          .then((blob) => {
            var url = window.URL.createObjectURL(blob);
            var a = document.createElement("a");
            a.href = url;
            a.download = "planilha_ordenada.xlsx";
            document.body.appendChild(a);
            a.click();
            a.remove();
          })
          .catch((error) => console.error("Error:", error));
      });
  </script>
</html>
